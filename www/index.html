<!doctype html>
<meta charset="UTF-8">
<meta name=viewport content="width=device-width, initial-scale=1">

<title>Voting Thing</title>
<link rel="stylesheet" href="css/all.min.css">
<script src="cordova.js"></script>
<script src="js/all.min.js"></script>

<div data-role="page" class="not-setup">

  <div data-role="panel" id="vt-panel" data-display="overlay" data-position="right">
    <form id="enter-room-form">
      <label for="room-input">Room</label>
      <input id="room-input" type="text" maxlength="20" data-clear-btn="true" required>
      <button data-theme="b">Enter Room</button>
    </form>
    <div class="room-area" data-role="collapsible" data-collapsed="false">
      <h2>Who's in the Room</h2>
      <ul data-role="listview" data-bind="foreach: people, jqmRefreshList: people">
        <li data-icon="edit"><!-- data-bind="attr: {'data-icon1': is_me ? 'edit' : null}" -->
          <!-- ko if: is_me -->
          <a data-bind="text: name, click: $parent.editName"></a>
          <!-- /ko -->
          <!-- ko ifnot: is_me -->
          <!--ko text: name--><!--/ko-->
          <!-- /ko -->
        </li>
      </ul>
    </div>
  </div>

  <div data-role="header">
    <h1>Voting Thing</h1>
    <a href="#vt-panel" class="hamburger ui-btn-right" data-icon="bars" data-iconpos="notext" data-role="button"></a>
  </div>

  <div role="main" class="ui-content">
    <div class="setup-area">
      <form id="setup-form">
        <label for="setup-name">What is your name?</label>
        <input id="setup-name" type="text" maxlength="20" data-clear-btn="true" required>
        <label for="setup-room">What room do you want to go to?</label>
        <input id="setup-room" type="text" maxlength="20" data-clear-btn="true" placeholder="Room name" required>
        <button data-theme="b">Enter</button>
      </form>
    </div>
    <div class="poll-and-votes-area">
      <div class="new-poll-area" data-role="collapsible">
        <h2>New Poll</h2>
        <label for="new-vote-name">Name</label>
        <input id="new-vote-name" type="text" maxlength="20" data-clear-btn="true">

        <div data-role="tabs" id="tabs">
          <div data-role="navbar" class="poll-type-select">
            <ul>
              <li><a href="#poll-type-item-choice" data-poll-type="item-choice" data-ajax="false" class="ui-btn-active">Item
                Choice</a></li>
              <li><a href="#poll-type-range" data-poll-type="range" data-ajax="false">Range</a></li>
            </ul>
          </div>
          <div id="poll-type-item-choice">
            <label for="new-item-choice" class="ui-hidden-accessible">New Item</label>
            <input id="new-item-choice" type="text" maxlength="20" data-clear-btn="true" placeholder="New Item">
            <button id="add-item-choice">Add Item</button>
            <ol data-role="listview" class="item-choices" data-inset="true"></ol>
          </div>
          <div id="poll-type-range">
            <div class="ui-grid-b">
              <div class="ui-block-a">
                <div class="ui-field-contain">
                  <label for="new-vote-min">Min</label>
                  <input id="new-vote-min" type="number" step="any">
                </div>
              </div>
              <div class="ui-block-b">
                <div class="ui-field-contain">
                  <label for="new-vote-max">Max</label>
                  <input id="new-vote-max" type="number" step="any">
                </div>
              </div>
              <div class="ui-block-c">
                <div class="ui-field-contain">
                  <label for="new-vote-step">Step</label>
                  <input id="new-vote-step" type="number" step="any">
                </div>
              </div>
            </div>
          </div>
        </div>
        <button id="create-poll-button" data-theme="b">Create Poll</button>
      </div>
      <div data-bind="foreach: polls">
        <div data-role="collapsible" data-collapsed="false" class="poll">
          <h2 data-bind="text: poll_name"></h2>

          <div class="vote-instance-input-area" data-bind="ifnot: haveIVoted">
            <!-- ko if: type === 'range' -->
            <input name="vote-input" type="number" data-bind="attr: {value: details.min, min: details.min, max: details.max, step: details.step}, jqmRefreshSlider">
            <!-- /ko -->
            <!-- ko if: type === 'item-choice' -->
            <fieldset data-role="controlgroup" data-bind="foreach: details.items, jqmRefreshCheckBoxRadio: details.items">
              <div class="ui-radio">
                <label class="ui-btn ui-btn-inherit ui-btn-icon-left ui-radio-off" data-bind="text: $data"></label>
                <input name="vote-input" type="radio" data-enhanced="true" data-bind="attr: {value: $data}">
              </div>
            </fieldset>
            <!-- /ko -->
            <button data-theme="b" data-bind="click: $parent.vote">Send My Vote</button>
          </div>

          <div data-bind="attr: {class: haveIVoted() ? 'voted' : 'not-voted'}">

            <!-- ko if: type === 'range' -->
            <table class="ui-table poll-results-table">
              <thead></thead>
              <tbody data-bind="foreach: votes">
              <tr>
                <td data-bind="text: name"></td>
                <td class="num" data-bind="text: $parent.haveIVoted() ? vote.toFixed($parent.decimals) : '?'"></td>
              </tr>
              </tbody>
              <tfoot>
              <tr>
                <th>Total</th>
                <th class="num" data-bind="text: voteSum"></th>
              </tr>
              <tr>
                <th>Average</th>
                <th class="num" data-bind="text: voteAvg"></th>
              </tr>
              </tfoot>
            </table>
            <!-- /ko -->

            <!-- ko if: type === 'item-choice' -->
            <table class="ui-table poll-results-summary-table">
              <tbody data-bind="foreach: details.items">
              <tr>
                <td data-bind="text: $data"></td>
                <td class="num" data-bind="text: $parent.itemTot($data)"></td>
              </tr>
              </tbody>
            </table>
            <hr>
            <table class="ui-table poll-results-table">
              <tbody data-bind="foreach: votes">
              <tr>
                <td data-bind="text: name"></td>
                <td class="num" data-bind="text: $parent.haveIVoted() ? vote : '?'"></td>
              </tr>
              </tbody>
            </table>
            <!-- /ko -->

          </div>

          <!-- ko if: ownPoll -->
          <button class="delete-poll-button" data-theme="b" data-bind="click: $parent.deletePollConfirm">Delete Poll
          </button>
          <!-- /ko -->

        </div>
      </div>
      <div class="poll-list-area"></div>
    </div>
  </div>

</div>